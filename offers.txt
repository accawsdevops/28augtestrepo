Code file from offers branch
